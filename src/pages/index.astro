---
import Base from "../../layouts/Base.astro";

// Eagerly grab all Markdown files in this folder at build time
const entries = import.meta.glob("./*.md", { eager: true });

// Build a simple list of routes/titles
const posts = Object.keys(entries)
  .map((k) => {
    const name = k.replace("./", "").replace(".md", "");
    // If your MD files have "title" in frontmatter, prefer it:
    // @ts-ignore - entries[k] is a Markdown instance with frontmatter
    const frontmatter = entries[k]?.frontmatter ?? {};
    return {
      route: `/blog/${name}`,
      title: frontmatter.title ?? name.replace(/-/g, " "),
    };
  })
  .sort((a, b) => a.title.localeCompare(b.title));
---

<Base title="Blog â€” Kullhem.io">
  <h1>Blog</h1>
  <ul>
    {posts.map((p) => <li><a href={p.route}>{p.title}</a></li>)}
  </ul>
</Base>
